<!DOCTYPE html>
<html>
<head>
<title>Phosphorus.Five - Enabling Agile Programming - phosphorus.expressions.Expression Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top">
<div id="titlearea">
  <a class="logo" title="Phosphorus.Five project main website" href="http://magixilluminate.com">
  <img alt="Magix Illuminate" src="magix-logo-big.png"/>
  </a>
  <h1 id="projectname">Phosphorus.Five</h1>
  <p id="projectbrief">Enabling Agile Programming</p>
  <a id="download-zip" title="Download Phosphorus.Five" href="https://github.com/polterguy/phosphorus-five/releases">&nbsp;</a>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacephosphorus.html">phosphorus</a></li><li class="navelem"><a class="el" href="namespacephosphorus_1_1expressions.html">expressions</a></li><li class="navelem"><a class="el" href="classphosphorus_1_1expressions_1_1Expression.html">Expression</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classphosphorus_1_1expressions_1_1Expression-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">phosphorus.expressions.Expression Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The main expression class in Phosphorus.Five.  
 <a href="classphosphorus_1_1expressions_1_1Expression.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aabc4a848a45001d2944c68a02e825fa8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphosphorus_1_1expressions_1_1Expression.html#aabc4a848a45001d2944c68a02e825fa8">Evaluate</a> (<a class="el" href="classphosphorus_1_1core_1_1Node.html">Node</a> node, <a class="el" href="classphosphorus_1_1core_1_1ApplicationContext.html">ApplicationContext</a> context)</td></tr>
<tr class="memdesc:aabc4a848a45001d2944c68a02e825fa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates expression for given <a class="el" href="classphosphorus_1_1core_1_1Node.html">node</a>.  <a href="#aabc4a848a45001d2944c68a02e825fa8">More...</a><br/></td></tr>
<tr class="separator:aabc4a848a45001d2944c68a02e825fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a332d6338f8061bfffb15814df89e7cb9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classphosphorus_1_1expressions_1_1Expression.html">Expression</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphosphorus_1_1expressions_1_1Expression.html#a332d6338f8061bfffb15814df89e7cb9">Create</a> (string expression)</td></tr>
<tr class="memdesc:a332d6338f8061bfffb15814df89e7cb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a new instance of the <a class="el" href="classphosphorus_1_1expressions_1_1Expression.html" title="The main expression class in Phosphorus.Five. ">phosphorus.expressions.Expression</a> class.  <a href="#a332d6338f8061bfffb15814df89e7cb9">More...</a><br/></td></tr>
<tr class="separator:a332d6338f8061bfffb15814df89e7cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a6ba2160f2238c74ccdef839cb8add88f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphosphorus_1_1expressions_1_1Expression.html#a6ba2160f2238c74ccdef839cb8add88f">RangeToken</a> (<a class="el" href="classphosphorus_1_1expressions_1_1iterators_1_1IteratorGroup.html">IteratorGroup</a> current, string token)</td></tr>
<tr class="separator:a6ba2160f2238c74ccdef839cb8add88f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f04d1622f7c4747629e7e93fa7c198"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphosphorus_1_1expressions_1_1Expression.html#a69f04d1622f7c4747629e7e93fa7c198">CreateMatchFromIterator</a> (<a class="el" href="classphosphorus_1_1expressions_1_1iterators_1_1IteratorGroup.html">IteratorGroup</a> group, string type)</td></tr>
<tr class="separator:a69f04d1622f7c4747629e7e93fa7c198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc35efa77531ddc5243f6960b7a899d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classphosphorus_1_1expressions_1_1Expression.html#adc35efa77531ddc5243f6960b7a899d6">EvaluateReferenceExpression</a> (<a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a> match, <a class="el" href="classphosphorus_1_1core_1_1ApplicationContext.html">ApplicationContext</a> context, string convert)</td></tr>
<tr class="separator:adc35efa77531ddc5243f6960b7a899d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The main expression class in Phosphorus.Five. </p>
<p>Responsible for parsing, building, and evaluating your pf.lambda expressions, according to what types of iterators you mix together, to form your complete expression.</p>
<p>An expression is normally recognized automatically by any Active Events that supports them, and starts with a "@" character, followed by any number of <a class="el" href="classphosphorus_1_1expressions_1_1iterators_1_1Iterator.html">Iterators</a>, ending with a type declaration.</p>
<p>Example;</p>
<pre>@/../"*"?node</pre><p>The above example will find all children nodes of the root node of your current execution tree.</p>
<p>There are 5 different types of expressions you can declare;</p>
<ol type="1">
<li><b>?value</b> - Returns the <a class="el" href="classphosphorus_1_1core_1_1Node.html#a8ab13998cba39192097e527649030b54">value</a> property of your nodes.</li>
<li><b>?name</b> - Returns the <a class="el" href="classphosphorus_1_1core_1_1Node.html#a7438762510f578b83575bd2f5061e9b7">name</a> property of your nodes.</li>
<li><b>?count</b> - Returns the <a class="el" href="classphosphorus_1_1core_1_1Node.html#a5e23f68b30ba9ff20ea1787acdf5041f">count</a> property of your nodes.</li>
<li><b>?path</b> - Returns the <a class="el" href="classphosphorus_1_1core_1_1Node.html#ad7bb8d84050417250c98af4120e4a2be">path</a> property of your nodes.</li>
<li><b>?node</b> - Returns the actual <a class="el" href="classphosphorus_1_1core_1_1Node.html">nodes</a> themselves.</li>
</ol>
<p>Both '?count' and '?path' types of expressions are "read-only", and cannot be used as destinations, or changed in any ways. All other types of expressions, can be both assigned to, and retrieved.</p>
<p>Each iterator, starts with a forward slash /, and ends with any of the following characters; "!&amp;^|()?/". If you wish to use any of the previously mentioned 8 special characters as parts of your iterators, you must put your entire iterator inside double-quotes, for instance;</p>
<pre>@/"foo&amp;bar"?value</pre><p>The above expression will look for a node who's name is "foo&amp;bar".</p>
<p>You can use any number of iterators when you compose your expressions, and each iterator will be evaluated in a left-to-right manner, which means that your first iterator will be evaluated first, and then used as the input to your next iterator. This makes your iterators becomes evaluated as a "chain of enumerables", where each iterator appends a new "filter criteria", and creates a new result, based upon its previous iterator, that it passes into the next iterator in the chain.</p>
<p>It might help to think of expressions as XPath expressions, since they to some extent do the same thing.</p>
<p>By mixing the different <a class="el" href="classphosphorus_1_1expressions_1_1iterators_1_1Iterator.html">Iterators</a> in your expressions, together with <a class="el" href="classphosphorus_1_1expressions_1_1Logical.html">Logicals</a>, allowing for you to perform Boolean Algebraic operations on expressions, and sub-expressions, you can probably extract any node-set you wish, from any starting pf.lambda node tree you wish to create a sub-set from. This is why it is a <em>"Hyperdimensional Boolean Algebraic graph object Expression 
    implementation"</em>. Since it allows you to treat graph objects, as if they have an infinite number of additional dimensions, in addition to the two that are automatically given in all graph objects, which are; width and height.</p>
<p>Below is an example of an expression that will extract all 'names', from all nodes from the root of your tree, having a parent node, who's value equals "foo", but who's name is not "bar", but only if the node has at least one children node of its own.</p>
<pre>@/../"**"(/=foo!/bar&amp;/0/.)?name</pre><p>To understand the powers of pf.lambda expressions might be difficult when you start using Phosphorus.Five. However, it might help to think of them as an alternative to algorithms, or a dynamica version of LINQ from C#, or stored IEnumerables, if you wish. But if you can imagine a result you wish to extract from a pf.lambda node tree, you can probably create an expression that can extract that node-set for you. For instance, imagine trying to set the value of all intelligent animals main value node to "yes", except Homo-Sapien, in the below data structure;</p>
<pre>_data
  homo-sapien
    iq:yes
  ape
    iq:yes
  donkey
    iq:no
  dog
    iq:no
  fish-like-mammals
    dolphins
      iq:yes
    salmon
      iq:no
    killer-whales
      iq:yes
set:@/../"**"/iq/=yes/.(!/homo-sapiens)?value
  source:yes</pre><p>Creating C# code to do the equivalent of the above pf.lambda expression, would end up in a monstrous, recursive, multiple methods implementation, spanning possibly dozens, if not more than 100 lines of code. With pf.lambda expressions, it's a simple one-liner expression, roughly 40 characters long.</p>
<p>With pf.lambda expressions, you can very often completely eliminate recursive method invocations, and in fact even conditional branching, and methods in general, by intelligently composing your expressions together, to extract what ever result-set you want to manipulate, or retrieve. With pf.lambda expressions, you can easily for instance create a list result-set, from a relational graph object, without resorting to recursive methods, or similar concepts. Consider for instance the code below, that creates a list of all the intelligent and sentient species on our planets;</p>
<pre>_destination
_data
  binary-based-life-forms
    terminator-t1
      iq:no
    World-Wide-Web
      iq:yes
  homo-sapien
    iq:yes
  ape
    iq:yes
  donkey
    iq:no
  dog
    iq:no
  fish-like-mammals
    dolphins
      iq:yes
    salmon
      iq:no
    killer-whales
      iq:yes
append:@/-2?node
  source:@/../"*"/_data/"**"/iq/=yes/.?name</pre><p>You can also convert the results of your expressions, to any of the types that there exists a <b>[pf.hyperlisp.get-object-value.xxx]</b> Active Event for. You do this by appending the type after your expression's type declaration, separated with a period (.). For instance, to convert the results of an expression to integers, you could use something like this;</p>
<pre>_input:5
_result
set:@/-?value
  source:@/./-2?value.int</pre><p>You can also create <em>"reference expressions"</em>, which are expressions leading to other expressions, where you do not want to retrieve the expressions your expression is leading too, but rather what those expressions are referring to. When you create reference expressions, then the results from your outer expressions will be evaluated, and if the results are another expression, then that expression will be evaluated, and its results returned back to the original caller. This way you can combine constant values and expressions, and create reference expressions, that will either return the constant they point to, or the value their referenced expressions points to. Consider this;</p>
<pre>_src:su
  first:@/.?value
  second:cc
  third:@/+?name
  ess
_destination
set:@/-?value
  source:@@/./-2/"*"?value</pre><p>Most Active Events in Phosphorus.Five can take expressions as their arguments. Understanding expressions, is key to learning Phosphorus.Five.</p>
<p>PS!<br/>
 Normally you don't want to consume this class directly, but instead use it indirectly through the <a class="el" href="classphosphorus_1_1expressions_1_1XUtil.html" title="Helper class for handling pf.lambda Expression objects. ">XUtil</a> class, which contains many helper methods to create and evaluate expressions for you!</p>
<p>PPS!<br/>
 You normally don't need to put neither the "*" iterator, nor the "**" inside of double-quotes, but since the documentation system we're using to create this manual, recognizes a slash (/) followed by an asterix (*) as a "special character", all places where we use the "*" iterator, and the "**" iterator, must be escaped inside of double-quotes for the documentation of Phosphorus.Five. This is not necessary when you create your own expressions, but a restriction of our documentation generator. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a332d6338f8061bfffb15814df89e7cb9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classphosphorus_1_1expressions_1_1Expression.html">Expression</a> phosphorus.expressions.Expression.Create </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>expression</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a new instance of the <a class="el" href="classphosphorus_1_1expressions_1_1Expression.html" title="The main expression class in Phosphorus.Five. ">phosphorus.expressions.Expression</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">expression</td><td>to evaluate</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a69f04d1622f7c4747629e7e93fa7c198"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a> phosphorus.expressions.Expression.CreateMatchFromIterator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classphosphorus_1_1expressions_1_1iterators_1_1IteratorGroup.html">IteratorGroup</a>&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>shares a lot of functionality with <a class="el" href="classphosphorus_1_1expressions_1_1XUtil.html#aa65397249089b8245311763e3c564374" title="Returns type of Expression. ">XUtil.ExpressionType</a>, try to refactor </dd></dl>

</div>
</div>
<a class="anchor" id="aabc4a848a45001d2944c68a02e825fa8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a> phosphorus.expressions.Expression.Evaluate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classphosphorus_1_1core_1_1Node.html">Node</a>&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classphosphorus_1_1core_1_1ApplicationContext.html">ApplicationContext</a>&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluates expression for given <a class="el" href="classphosphorus_1_1core_1_1Node.html">node</a>. </p>
<p>Returns a match object wrapping the result from your <a class="el" href="classphosphorus_1_1expressions_1_1Expression.html" title="The main expression class in Phosphorus.Five. ">Expression</a>.</p>
<p>PS! Normally you very seldom want to use this method directly, or this class for that matter, but instead use one of the helper methods in the <a class="el" href="classphosphorus_1_1expressions_1_1XUtil.html" title="Helper class for handling pf.lambda Expression objects. ">XUtil</a> class, which takes care of creating expressions, and evaluating then automatically for you. </p>

</div>
</div>
<a class="anchor" id="adc35efa77531ddc5243f6960b7a899d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a> phosphorus.expressions.Expression.EvaluateReferenceExpression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classphosphorus_1_1expressions_1_1Match.html">Match</a>&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classphosphorus_1_1core_1_1ApplicationContext.html">ApplicationContext</a>&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>convert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>support formatting expressions through delegate callbacks, such that <a class="el" href="classphosphorus_1_1expressions_1_1XUtil.html#a28173d1da6e407ffe67181c33410e63c" title="Iterates all matches on Node. ">XUtil.Iterate</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a6ba2160f2238c74ccdef839cb8add88f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void phosphorus.expressions.Expression.RangeToken </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classphosphorus_1_1expressions_1_1iterators_1_1IteratorGroup.html">IteratorGroup</a>&#160;</td>
          <td class="paramname"><em>current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>cleanup, too long ... </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
  <p id="copyright-notice">Phosphorus.Five is Free and Open Source Software. Phosphorus is licensed under the terms of the <a href="http://opensource.org/licenses/MIT">MIT license</a>. Phosphorus is a <a href="http://magixilluminate.com">Magix Illuminate</a> Production. <a href="https://github.com/polterguy/phosphorus-five/issues">Report a bug, or an issue</a>.</p>
</body>
</html>
